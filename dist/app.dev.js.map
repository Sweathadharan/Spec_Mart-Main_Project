{"version":3,"sources":["app.js"],"names":["express","require","path","favicon","morgan","cookieParser","bodyParser","csrf","session","passport","flash","app","set","join","__dirname","locals","pretty","use","csrfProtection","cookie","json","urlencoded","extended","secret","saveUninitialized","resave","initialize","routes","users","products","checkout","press","services","contact","admin","profile","eyetest","req","res","next","err","error","msg","notice","success","Error","status","get","render","message","module","exports"],"mappings":";;AAAA,IAAIA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAArB;;AAEA,IAAIC,IAAI,GAAGD,OAAO,CAAC,MAAD,CAAlB;;AAEA,IAAIE,OAAO,GAAGF,OAAO,CAAC,eAAD,CAArB;;AACA,IAAIG,MAAM,GAAGH,OAAO,CAAC,QAAD,CAApB,C,CAEA;;;AACA,IAAII,YAAY,GAAGJ,OAAO,CAAC,eAAD,CAA1B;;AACA,IAAIK,UAAU,GAAGL,OAAO,CAAC,aAAD,CAAxB;;AACA,IAAIM,IAAI,GAAGN,OAAO,CAAC,MAAD,CAAlB;;AACA,IAAIO,OAAO,GAAGP,OAAO,CAAC,iBAAD,CAArB;;AACA,IAAIQ,QAAQ,GAAGR,OAAO,CAAC,UAAD,CAAtB;;AACA,IAAIS,KAAK,GAAGT,OAAO,CAAC,eAAD,CAAnB;;AAEA,IAAIU,GAAG,GAAGX,OAAO,EAAjB,C,CAEA;;AACAW,GAAG,CAACC,GAAJ,CAAQ,OAAR,EAAiBV,IAAI,CAACW,IAAL,CAAUC,SAAV,EAAqB,OAArB,CAAjB;AACAH,GAAG,CAACC,GAAJ,CAAQ,aAAR,EAAuB,MAAvB,E,CACA;;AACAD,GAAG,CAACI,MAAJ,CAAWC,MAAX,GAAoB,IAApB,C,CAEA;AACI;;AACJL,GAAG,CAACM,GAAJ,CAAQd,OAAO,CAACD,IAAI,CAACW,IAAL,CAAUC,SAAV,EAAqB,QAArB,EAA+B,sBAA/B,CAAD,CAAf,E,CACI;;AACJH,GAAG,CAACM,GAAJ,CAAQb,MAAM,CAAC,KAAD,CAAd,E,CACI;;AACJ,IAAIc,cAAc,GAAGX,IAAI,CAAC;AAAEY,EAAAA,MAAM,EAAE;AAAV,CAAD,CAAzB,C,CACI;;AACJR,GAAG,CAACM,GAAJ,CAAQX,UAAU,CAACc,IAAX,EAAR;AACAT,GAAG,CAACM,GAAJ,CAAQX,UAAU,CAACe,UAAX,CAAsB;AAACC,EAAAA,QAAQ,EAAE;AAAX,CAAtB,CAAR,E,CACI;;AACJX,GAAG,CAACM,GAAJ,CAAQZ,YAAY,EAApB,E,CACI;;AACJM,GAAG,CAACM,GAAJ,CAAQjB,OAAO,UAAP,CAAeE,IAAI,CAACW,IAAL,CAAUC,SAAV,EAAqB,QAArB,CAAf,CAAR,E,CACI;;AACJH,GAAG,CAACM,GAAJ,CAAQT,OAAO,CAAC;AAAEe,EAAAA,MAAM,EAAE,aAAV;AAAyBC,EAAAA,iBAAiB,EAAE,IAA5C;AAAkDC,EAAAA,MAAM,EAAE;AAA1D,CAAD,CAAf,E,CACI;;AACJxB,OAAO,CAAC,mBAAD,CAAP,CAA6BQ,QAA7B,E,CACI;;;AACJE,GAAG,CAACM,GAAJ,CAAQR,QAAQ,CAACiB,UAAT,EAAR,E,CACI;;AACJf,GAAG,CAACM,GAAJ,CAAQR,QAAQ,CAACD,OAAT,EAAR,E,CACI;;AACJG,GAAG,CAACM,GAAJ,CAAQP,KAAK,EAAb,E,CAEA;;AACA,IAAIiB,MAAM,GAAG1B,OAAO,CAAC,iBAAD,CAApB;;AACA,IAAI2B,KAAK,GAAG3B,OAAO,CAAC,gBAAD,CAAP,CAA0BU,GAA1B,EAA+BF,QAA/B,CAAZ;;AACA,IAAIoB,QAAQ,GAAG5B,OAAO,CAAC,eAAD,CAAtB;;AACA,IAAI6B,QAAQ,GAAG7B,OAAO,CAAC,mBAAD,CAAtB;;AACA,IAAI8B,KAAK,GAAG9B,OAAO,CAAC,gBAAD,CAAnB;;AACA,IAAI+B,QAAQ,GAAG/B,OAAO,CAAC,mBAAD,CAAtB;;AACA,IAAIgC,OAAO,GAAGhC,OAAO,CAAC,kBAAD,CAArB;;AACA,IAAIiC,KAAK,GAAGjC,OAAO,CAAC,gBAAD,CAAnB;;AACA,IAAIkC,OAAO,GAAGlC,OAAO,CAAC,kBAAD,CAArB;;AACA,IAAImC,OAAO,GAAGnC,OAAO,CAAC,mBAAD,CAArB,C,CAGA;;;AAEAU,GAAG,CAACM,GAAJ,CAAQ,GAAR,EAAaU,MAAb;AACAhB,GAAG,CAACM,GAAJ,CAAQ,OAAR,EAAiBY,QAAjB;AACAlB,GAAG,CAACM,GAAJ,CAAQ,WAAR,EAAqBa,QAArB;AACAnB,GAAG,CAACM,GAAJ,CAAQ,QAAR,EAAkBc,KAAlB;AACApB,GAAG,CAACM,GAAJ,CAAQ,WAAR,EAAqBe,QAArB;AACArB,GAAG,CAACM,GAAJ,CAAQ,aAAR,EAAuBgB,OAAvB;AACAtB,GAAG,CAACM,GAAJ,CAAQ,QAAR,EAAkBiB,KAAlB;AACAvB,GAAG,CAACM,GAAJ,CAAQ,MAAR,EAAgBkB,OAAhB;AACAxB,GAAG,CAACM,GAAJ,CAAQ,WAAR,EAAqBmB,OAArB,E,CAGA;;AACAzB,GAAG,CAACM,GAAJ,CAAQ,UAASoB,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAwB;AAC5B,MAAIC,GAAG,GAAGH,GAAG,CAAC7B,OAAJ,CAAYiC,KAAtB;AAAA,MACIC,GAAG,GAAGL,GAAG,CAAC7B,OAAJ,CAAYmC,MADtB;AAAA,MAEIC,OAAO,GAAGP,GAAG,CAAC7B,OAAJ,CAAYoC,OAF1B;AAIA,SAAOP,GAAG,CAAC7B,OAAJ,CAAYiC,KAAnB;AACA,SAAOJ,GAAG,CAAC7B,OAAJ,CAAYoC,OAAnB;AACA,SAAOP,GAAG,CAAC7B,OAAJ,CAAYmC,MAAnB;AAEA,MAAIH,GAAJ,EAASF,GAAG,CAACvB,MAAJ,CAAW0B,KAAX,GAAmBD,GAAnB;AACT,MAAIE,GAAJ,EAASJ,GAAG,CAACvB,MAAJ,CAAW4B,MAAX,GAAoBD,GAApB;AACT,MAAIE,OAAJ,EAAaN,GAAG,CAACvB,MAAJ,CAAW6B,OAAX,GAAqBA,OAArB;AAEbL,EAAAA,IAAI;AACP,CAdD,E,CAiBA;;AACA5B,GAAG,CAACM,GAAJ,CAAQ,UAAUoB,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAC9B,MAAIC,GAAG,GAAG,IAAIK,KAAJ,CAAU,WAAV,CAAV;AACAL,EAAAA,GAAG,CAACM,MAAJ,GAAa,GAAb;AACAP,EAAAA,IAAI,CAACC,GAAD,CAAJ;AACH,CAJD,E,CAMA;AAEA;AACA;;AACA,IAAI7B,GAAG,CAACoC,GAAJ,CAAQ,KAAR,MAAmB,aAAvB,EAAsC;AAClCpC,EAAAA,GAAG,CAACM,GAAJ,CAAQ,UAAUuB,GAAV,EAAeH,GAAf,EAAoBC,GAApB,EAAyBC,IAAzB,EAA+B;AACnCD,IAAAA,GAAG,CAACQ,MAAJ,CAAWN,GAAG,CAACM,MAAJ,IAAc,GAAzB;AACAR,IAAAA,GAAG,CAACU,MAAJ,CAAW,OAAX,EAAoB;AAChBC,MAAAA,OAAO,EAAET,GAAG,CAACS,OADG;AAEhBR,MAAAA,KAAK,EAAED;AAFS,KAApB;AAIH,GAND;AAOH,C,CAED;AACA;;;AACA7B,GAAG,CAACM,GAAJ,CAAQ,UAAUuB,GAAV,EAAeH,GAAf,EAAoBC,GAApB,EAAyBC,IAAzB,EAA+B;AACnCD,EAAAA,GAAG,CAACQ,MAAJ,CAAWN,GAAG,CAACM,MAAJ,IAAc,GAAzB;AACAR,EAAAA,GAAG,CAACU,MAAJ,CAAW,OAAX,EAAoB;AAChBC,IAAAA,OAAO,EAAET,GAAG,CAACS,OADG;AAEhBR,IAAAA,KAAK,EAAE;AAFS,GAApB;AAIH,CAND;AAWAS,MAAM,CAACC,OAAP,GAAiBxC,GAAjB","sourcesContent":["var express = require('express');\n\nvar path = require('path');\n\nvar favicon = require('serve-favicon');\nvar morgan = require('morgan');\n\n// authentication modules\nvar cookieParser = require('cookie-parser');\nvar bodyParser = require('body-parser');\nvar csrf = require('csrf');\nvar session = require('express-session');\nvar passport = require('passport');\nvar flash = require('connect-flash');\n\nvar app = express();\n\n// view engine setup\napp.set('views', path.join(__dirname, 'views'));\napp.set('view engine', 'jade');\n//Reformat HTML code after renders\napp.locals.pretty = true;\n\n// set up express application\n    // setup favicon if needed\napp.use(favicon(path.join(__dirname, 'public', '/img/ico/favicon.ico')));\n    // log every request to the console\napp.use(morgan('dev'));\n    // csrf token init\nvar csrfProtection = csrf({ cookie: true });\n    // get info from html forms\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({extended: false}));\n    // read cookies\napp.use(cookieParser());\n    // setup static directory\napp.use(express.static(path.join(__dirname, 'public')));\n    // setup session secret\napp.use(session({ secret: 'anhpham1509', saveUninitialized: true, resave: true }));\n    // pass passport for configuration\nrequire('./config/passport')(passport);\n    // init passport\napp.use(passport.initialize());\n    // persistent login sessions\napp.use(passport.session());\n    // use connect-flash for flash messages stored in session\napp.use(flash());\n\n// routes\nvar routes = require('./routes/routes');\nvar users = require('./routes/users')(app, passport);\nvar products = require('./routes/cart');\nvar checkout = require('./routes/checkout');\nvar press = require('./routes/press');\nvar services = require('./routes/services');\nvar contact = require('./routes/contact');\nvar admin = require('./routes/admin');\nvar profile = require('./routes/profile');\nvar eyetest = require('./routes/eye-test');\n\n\n//require('./routes/users')(app, passport);\n\napp.use('/', routes);\napp.use('/cart', products);\napp.use('/checkout', checkout);\napp.use('/press', press);\napp.use('/services', services);\napp.use('/contact-us', contact);\napp.use('/admin', admin);\napp.use('/usr', profile);\napp.use('/eye-test', eyetest);\n\n\n// Session-persisted message middleware\napp.use(function(req, res, next){\n    var err = req.session.error,\n        msg = req.session.notice,\n        success = req.session.success;\n\n    delete req.session.error;\n    delete req.session.success;\n    delete req.session.notice;\n\n    if (err) res.locals.error = err;\n    if (msg) res.locals.notice = msg;\n    if (success) res.locals.success = success;\n\n    next();\n});\n\n\n// catch 404 and forward to error handler\napp.use(function (req, res, next) {\n    var err = new Error('Not Found');\n    err.status = 404;\n    next(err);\n});\n\n// error handlers\n\n// development error handler\n// will print stacktrace\nif (app.get('env') === 'development') {\n    app.use(function (err, req, res, next) {\n        res.status(err.status || 500);\n        res.render('error', {\n            message: err.message,\n            error: err\n        });\n    });\n}\n\n// production error handler\n// no stacktraces leaked to user\napp.use(function (err, req, res, next) {\n    res.status(err.status || 500);\n    res.render('error', {\n        message: err.message,\n        error: {}\n    });\n});\n\n\n\n\nmodule.exports = app;\n"],"file":"app.dev.js"}