{"version":3,"sources":["users.js"],"names":["module","exports","app","passport","get","req","res","session","inCheckOut","checkOutNoti","contextDict","signInError","flash","render","successRedirect","authenticate","failureRedirect","failureFlash","post","title","signUpError","logout","redirect"],"mappings":"aA6CAA,OAAOC,QAAU,SAAUC,EAAKC,GAE5BD,EAAIE,IAAI,WAAY,SAAUC,EAAKC,GAE3BD,GAAIE,EAAAA,QAAQC,WAAW,CACnBC,IAAAA,EAAe,0FAEfF,EAAAA,QAAQC,YAAZ,EAEJ,IAAIE,EAAc,CAAdA,MAAW,UACNC,YADSN,EAAAO,MAAA,eAEdD,aAAiBC,GAFrBN,EAAAO,OAAA,UAAAH,KAQJR,EAAIE,IAAI,YAAa,SAAUC,EAAKC,GAC5BO,EAAAA,OAAO,cAKXC,EAAAA,KAAAA,YAAiBX,EADkCY,aAAA,UAAA,CACtBD,gBAAA,WAC7BE,gBAAiB,WAAYC,cAAA,KAKjCf,EAAIgB,KAAK,WAAYf,EAASY,aAAa,UAAW,CAClDD,gBAAiB,QAASE,gBAAA,WAC1BA,cAAiB,KAIrBd,EAAIE,IAAI,WAAY,SAAUC,EAAKC,GAA/BF,GAAIC,EAAAE,QAAYC,WAAA,CAChB,IAAAC,EAAA,0FAEQA,EAAAA,QAAYD,YAAG,EAEnBH,IAAIE,EAAQC,CACfW,MAAA,UAGGC,YAAaf,EAAIO,MAAM,eAFvBF,aAAcD,GAGdA,EAAAA,OAAY,UAAEA,KAOtBP,EAAIgB,KAAK,WAAYf,EAASY,aAAa,UAAW,CAAlDG,gBAAiBf,OACjBW,gBAAiB,WAAQG,cAAA,KAEzBA,EAAAA,IAAAA,YAAmB,SAAAZ,EAAAC,GAInBD,EAAIgB,SAPRf,EAAAgB,SAAA","file":"users.min.js","sourcesContent":["/*var express = require('express');\n var router = express.Router();\n var passport = require('../app').passport;\n\n router.route('/sign-in')\n .get(function (req, res) {\n var contextDict = {\n title: 'Sign In',\n navList: [{name: 'hello', link: 'bye'}],\n signInError: req.flash('signInError')\n };\n res.render('sign-in', contextDict);\n })\n\n .post(passport.authenticate('sign-in', {\n successRedirect: '/', // redirect to the secure profile section\n failureRedirect: '/users/sign-in', // redirect back to the signup page if there is an error\n failureFlash: true // allow flash messages\n }));\n\n router.route('/sign-up')\n .get(function (req, res) {\n var contextDict = {\n title: 'Sign Up',\n navList: [{name: 'hello', link: 'bye'}],\n signUpError: req.flash('signUpError')\n };\n res.render('sign-up', contextDict);\n })\n\n .post(passport.authenticate('sign-up', {\n successRedirect: '/', // redirect to the secure profile section\n failureRedirect: '/users/sign-up', // redirect back to the signup page if there is an error\n failureFlash: true // allow flash messages\n }));\n\n router.route('/sign-out')\n .get(function (req, res) {\n req.logout();\n res.redirect('/');\n });\n\n module.exports = router;\n */\n\nmodule.exports = function (app, passport) {\n\n    app.get('/sign-in', function (req, res) {\n        // render the page and pass in any flash data if it exists\n        if (req.session.inCheckOut){\n            var checkOutNoti = 'You need to sign in to check out!\\\n                Please sign up if you do not have one!';\n            req.session.inCheckOut = false;\n        }\n        var contextDict = {\n            title: 'Sign In',\n            signInError: req.flash('signInError'),\n            checkOutNoti: checkOutNoti\n        };\n        res.render('sign-in', contextDict);\n    });\n    \n    app.get('/eye-test', function (req, res) {\n        res.render('eye-test');\n    });\n\n    // process the signup form\n    app.post('/eye-test', passport.authenticate('sign-up', {\n        successRedirect: '/sign-in', // redirect to the secure profile section\n        failureRedirect: '/sign-up', // redirect back to the signup page if there is an error\n        failureFlash: true // allow flash messages\n    }));\n\n\n    app.post('/sign-in', passport.authenticate('sign-in', {\n        successRedirect: '/usr/', // redirect to the secure profile section\n        failureRedirect: '/sign-in', // redirect back to the signup page if there is an error\n        failureFlash: true // allow flash messages\n    }));\n\n    app.get('/sign-up', function (req, res) {\n        // render the page and pass in any flash data if it exists\n        if (req.session.inCheckOut){\n            var checkOutNoti = 'You need to sign in to check out!\\\n                Please sign up if you do not have one!';\n            req.session.inCheckOut = false;\n        }\n        var contextDict = {\n            title: 'Sign Up',\n            signUpError: req.flash('signUpError'),\n            checkOutNoti: checkOutNoti\n        };\n\n        res.render('sign-up', contextDict);\n    });\n\n    // process the signup form\n    app.post('/sign-up', passport.authenticate('sign-up', {\n        successRedirect: '/usr', // redirect to the secure profile section\n        failureRedirect: '/sign-up', // redirect back to the signup page if there is an error\n        failureFlash: true // allow flash messages\n    }));\n\n    app.get('/sign-out', function (req, res) {\n        req.logout();\n        res.redirect('/');\n    });\n\n    function isLoggedIn(req, res, next) {\n\n        // if user is authenticated in the session, carry on\n        if (req.isAuthenticated())\n            return next();\n\n        // if they aren't redirect them to the home page\n        res.redirect('/');\n    }\n\n};"]}