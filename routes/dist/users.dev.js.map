{"version":3,"sources":["users.js"],"names":["module","exports","app","passport","get","req","res","session","inCheckOut","checkOutNoti","contextDict","title","signInError","flash","render","post","authenticate","successRedirect","failureRedirect","failureFlash","signUpError","logout","redirect","isLoggedIn","next","isAuthenticated"],"mappings":";;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CAA,MAAM,CAACC,OAAP,GAAiB,UAAUC,GAAV,EAAeC,QAAf,EAAyB;AAEtCD,EAAAA,GAAG,CAACE,GAAJ,CAAQ,UAAR,EAAoB,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AACpC;AACA,QAAID,GAAG,CAACE,OAAJ,CAAYC,UAAhB,EAA2B;AACvB,UAAIC,YAAY,GAAG;uDAAnB;AAEAJ,MAAAA,GAAG,CAACE,OAAJ,CAAYC,UAAZ,GAAyB,KAAzB;AACH;;AACD,QAAIE,WAAW,GAAG;AACdC,MAAAA,KAAK,EAAE,SADO;AAEdC,MAAAA,WAAW,EAAEP,GAAG,CAACQ,KAAJ,CAAU,aAAV,CAFC;AAGdJ,MAAAA,YAAY,EAAEA;AAHA,KAAlB;AAKAH,IAAAA,GAAG,CAACQ,MAAJ,CAAW,SAAX,EAAsBJ,WAAtB;AACH,GAbD;AAeAR,EAAAA,GAAG,CAACE,GAAJ,CAAQ,WAAR,EAAqB,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AACrCA,IAAAA,GAAG,CAACQ,MAAJ,CAAW,UAAX;AACH,GAFD,EAjBsC,CAqBtC;;AACAZ,EAAAA,GAAG,CAACa,IAAJ,CAAS,WAAT,EAAsBZ,QAAQ,CAACa,YAAT,CAAsB,SAAtB,EAAiC;AACnDC,IAAAA,eAAe,EAAE,UADkC;AACtB;AAC7BC,IAAAA,eAAe,EAAE,UAFkC;AAEtB;AAC7BC,IAAAA,YAAY,EAAE,IAHqC,CAGhC;;AAHgC,GAAjC,CAAtB;AAOAjB,EAAAA,GAAG,CAACa,IAAJ,CAAS,UAAT,EAAqBZ,QAAQ,CAACa,YAAT,CAAsB,SAAtB,EAAiC;AAClDC,IAAAA,eAAe,EAAE,OADiC;AACxB;AAC1BC,IAAAA,eAAe,EAAE,UAFiC;AAErB;AAC7BC,IAAAA,YAAY,EAAE,IAHoC,CAG/B;;AAH+B,GAAjC,CAArB;AAMAjB,EAAAA,GAAG,CAACE,GAAJ,CAAQ,UAAR,EAAoB,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AACpC;AACA,QAAID,GAAG,CAACE,OAAJ,CAAYC,UAAhB,EAA2B;AACvB,UAAIC,YAAY,GAAG;uDAAnB;AAEAJ,MAAAA,GAAG,CAACE,OAAJ,CAAYC,UAAZ,GAAyB,KAAzB;AACH;;AACD,QAAIE,WAAW,GAAG;AACdC,MAAAA,KAAK,EAAE,SADO;AAEdS,MAAAA,WAAW,EAAEf,GAAG,CAACQ,KAAJ,CAAU,aAAV,CAFC;AAGdJ,MAAAA,YAAY,EAAEA;AAHA,KAAlB;AAMAH,IAAAA,GAAG,CAACQ,MAAJ,CAAW,SAAX,EAAsBJ,WAAtB;AACH,GAdD,EAnCsC,CAmDtC;;AACAR,EAAAA,GAAG,CAACa,IAAJ,CAAS,UAAT,EAAqBZ,QAAQ,CAACa,YAAT,CAAsB,SAAtB,EAAiC;AAClDC,IAAAA,eAAe,EAAE,MADiC;AACzB;AACzBC,IAAAA,eAAe,EAAE,UAFiC;AAErB;AAC7BC,IAAAA,YAAY,EAAE,IAHoC,CAG/B;;AAH+B,GAAjC,CAArB;AAMAjB,EAAAA,GAAG,CAACE,GAAJ,CAAQ,WAAR,EAAqB,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AACrCD,IAAAA,GAAG,CAACgB,MAAJ;AACAf,IAAAA,GAAG,CAACgB,QAAJ,CAAa,GAAb;AACH,GAHD;;AAKA,WAASC,UAAT,CAAoBlB,GAApB,EAAyBC,GAAzB,EAA8BkB,IAA9B,EAAoC;AAEhC;AACA,QAAInB,GAAG,CAACoB,eAAJ,EAAJ,EACI,OAAOD,IAAI,EAAX,CAJ4B,CAMhC;;AACAlB,IAAAA,GAAG,CAACgB,QAAJ,CAAa,GAAb;AACH;AAEJ,CAzED","sourcesContent":["/*var express = require('express');\n var router = express.Router();\n var passport = require('../app').passport;\n\n router.route('/sign-in')\n .get(function (req, res) {\n var contextDict = {\n title: 'Sign In',\n navList: [{name: 'hello', link: 'bye'}],\n signInError: req.flash('signInError')\n };\n res.render('sign-in', contextDict);\n })\n\n .post(passport.authenticate('sign-in', {\n successRedirect: '/', // redirect to the secure profile section\n failureRedirect: '/users/sign-in', // redirect back to the signup page if there is an error\n failureFlash: true // allow flash messages\n }));\n\n router.route('/sign-up')\n .get(function (req, res) {\n var contextDict = {\n title: 'Sign Up',\n navList: [{name: 'hello', link: 'bye'}],\n signUpError: req.flash('signUpError')\n };\n res.render('sign-up', contextDict);\n })\n\n .post(passport.authenticate('sign-up', {\n successRedirect: '/', // redirect to the secure profile section\n failureRedirect: '/users/sign-up', // redirect back to the signup page if there is an error\n failureFlash: true // allow flash messages\n }));\n\n router.route('/sign-out')\n .get(function (req, res) {\n req.logout();\n res.redirect('/');\n });\n\n module.exports = router;\n */\n\nmodule.exports = function (app, passport) {\n\n    app.get('/sign-in', function (req, res) {\n        // render the page and pass in any flash data if it exists\n        if (req.session.inCheckOut){\n            var checkOutNoti = 'You need to sign in to check out!\\\n                Please sign up if you do not have one!';\n            req.session.inCheckOut = false;\n        }\n        var contextDict = {\n            title: 'Sign In',\n            signInError: req.flash('signInError'),\n            checkOutNoti: checkOutNoti\n        };\n        res.render('sign-in', contextDict);\n    });\n    \n    app.get('/eye-test', function (req, res) {\n        res.render('eye-test');\n    });\n\n    // process the signup form\n    app.post('/eye-test', passport.authenticate('sign-up', {\n        successRedirect: '/sign-in', // redirect to the secure profile section\n        failureRedirect: '/sign-up', // redirect back to the signup page if there is an error\n        failureFlash: true // allow flash messages\n    }));\n\n\n    app.post('/sign-in', passport.authenticate('sign-in', {\n        successRedirect: '/usr/', // redirect to the secure profile section\n        failureRedirect: '/sign-in', // redirect back to the signup page if there is an error\n        failureFlash: true // allow flash messages\n    }));\n\n    app.get('/sign-up', function (req, res) {\n        // render the page and pass in any flash data if it exists\n        if (req.session.inCheckOut){\n            var checkOutNoti = 'You need to sign in to check out!\\\n                Please sign up if you do not have one!';\n            req.session.inCheckOut = false;\n        }\n        var contextDict = {\n            title: 'Sign Up',\n            signUpError: req.flash('signUpError'),\n            checkOutNoti: checkOutNoti\n        };\n\n        res.render('sign-up', contextDict);\n    });\n\n    // process the signup form\n    app.post('/sign-up', passport.authenticate('sign-up', {\n        successRedirect: '/usr', // redirect to the secure profile section\n        failureRedirect: '/sign-up', // redirect back to the signup page if there is an error\n        failureFlash: true // allow flash messages\n    }));\n\n    app.get('/sign-out', function (req, res) {\n        req.logout();\n        res.redirect('/');\n    });\n\n    function isLoggedIn(req, res, next) {\n\n        // if user is authenticated in the session, carry on\n        if (req.isAuthenticated())\n            return next();\n\n        // if they aren't redirect them to the home page\n        res.redirect('/');\n    }\n\n};"],"file":"users.dev.js"}