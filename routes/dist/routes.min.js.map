{"version":3,"sources":["routes.js"],"names":["express","require","router","Router","RunQuery","database","next","sqlStr","categories","products","contextDict","currentUrl","featProducts","user","render","route","all","req","res","customer","post","title","log","body","dataone","emb","Status","console","params","catSlug","selectQuery","product","CategoryName","prodSlug","ProductName","email","result","redirect","get","module","exports"],"mappings":"aAAA,IAAIA,QAAUC,QAAQ,WAClBC,OAASF,QAAQG,SAAjBD,SAASF,QAAQG,sBAIjBC,SAAWC,SAASD,SAAxBF,OAAIE,IAAAA,IAAWC,SAASD,EAAAA,EAAxBE,GAEA,IAAAC,EAAA,0CAMIH,SAASG,EAAQ,SAAUC,GAQvBJ,SAPAG,EAAS,mOAOQ,SAPjBE,GAOQ,IAACF,EAAQ,CACTG,WAAc,IACdC,MADc,OAEPH,WAFOA,EAGdA,aAHcC,EAIdG,SAAcH,EAJAI,MASdC,EAAJA,OAAW,QAASJ,SAMhCR,OAAOa,MAAM,SAELC,IAAIT,SAASU,EAAAC,EAAAZ,GAMLK,SANK,0CAKS,SAAAH,GAET,IAAEE,EAFO,CAGJC,WAHI,OAIJM,MAAIJ,aAJlBL,WAAAA,EAOWW,SAAAF,EAAcP,MAKrCQ,EAAaJ,OAAA,aACRJ,OAQLR,OAAAa,MAAA,gBAEAC,IAAA,SAAAC,EAAAC,EAAAZ,GAEOc,EAAKN,OAAA,gBAUJH,OAAAA,KAAAA,iBADc,SAAAM,EAAAC,GAEdG,QAAKC,IAAEL,EAAAM,KAFOC,SAGdC,IAAAA,EAHcR,EAAAM,KAAAC,QAAlBjB,EAAA,gDAIIY,IAAAA,OAAUF,EAAVE,KAIJD,QAAIJ,IAAOP,GATXH,SAWAG,EAAA,SAAAkB,GAOJ,IAAAf,EAAA,CACAC,WAAA,UACAU,MAAA,SACAI,IAAAA,EACAN,SAAAF,EAAAS,QAIAxB,QAAAoB,IAAa,yCAELK,QAAAL,IAAAZ,EAAAe,KACAP,EAAAJ,OAAA,eAAAJ,OAsBRR,OAAAa,MAAA,eACAC,IAAA,SAAAC,EAAAC,EAAAZ,GASAF,SALA,kFAKA,SAAAqB,GACA,IAAAf,EAAA,CACAC,WAAA,MA1BgBU,MAAO,SAgCvBI,IAAAA,EA9BgBN,SAAUF,EAAIS,QAiCdE,QAAOC,IAAX,yCACIC,QAAWR,IAAGZ,EAAAe,KA9BlBP,EAAIJ,OAAO,eAAgBJ,OA2BvCR,OAAOa,MAAM,iBACRC,IAAI,SAAUC,EAAKC,EAAKZ,GAyCbF,GAA2BI,OAA3BJ,EAASG,OAAQsB,QAAUrB,CAEnBE,IAAAA,EAAc,sNAOdI,SAAOgB,EAAA,SAAoBpB,GApCnCN,SAqBJ0B,EAAA,0DArB0B,SAAUtB,GA6C3B,IAAAE,EAAA,CA1CGW,MAAO,eACPZ,SAAUA,EACVD,WA2CUS,EAETE,SAAUY,EAASlB,MAInBkB,EAAOjB,OAFF,mBAAAJ,WAFtB,CAPR,IAAAH,EAAA,uQAyB2CU,EAAAW,OAAAC,QAAA,IAAnCzB,SAAAG,EAAA,SAAAE,GAgBRL,SAVaG,EACR,0DASL,SAAAC,GAvDoB,IAAIE,EAAc,CA2DtCW,MAAAZ,EAAA,GAAAuB,aAzDwBvB,SAAUA,EACVD,WAAYA,EACZW,SAAUF,EAAIJ,MAGlBK,EAAIJ,OAAO,mBAAoBJ,UAOnDR,OAAOa,MAAM,2BACRC,IAAI,SAAUC,EAAKC,EAAKZ,GACrB,IAAIC,EAAS,qEAGaU,EAAIW,OAAOK,SAAW,IAEhD7B,SAASG,EAAQ,SAAUwB,GAEvB,IAAIrB,EAAc,CACdW,MAAOU,EAAQ,GAAGG,YAClBH,QAASA,EAAQ,GACjBZ,SAAUF,EAAIJ,MAGlBK,EAAIJ,OAAO,gBAAiBJ,OAIxCR,OAAOa,MAAM,cACRK,KAAK,SAAUH,EAAKC,EAAKZ,GACtB,IAAIC,EAAS,mDAECU,EAAIM,KAAKY,MAAQ,KAE/B/B,SAASG,EAAQ,SAAU6B,GACvBlB,EAAImB,SAAS,SAKzBnC,OAAOa,MAAM,QACZuB,IAAI,SAAUrB,EAAKC,GAEhBA,EAAIJ,OAAO,SAgCfyB,OAAOC,QAAUtC","file":"routes.min.js","sourcesContent":["var express = require('express');\nvar router = express.Router();\n\n// database module\nvar database = require('../config/database');\nvar RunQuery = database.RunQuery;\n\n/* Route Home page. */\nrouter.all('/', function (req, res, next) {\n    var sqlStr = '\\\n        SELECT *\\\n        FROM Categories';\n\n    RunQuery(sqlStr, function (categories) {\n        sqlStr = '\\\n            SELECT Products.*, Categories.CategoryName, Categories.CategorySlug\\\n            FROM Products\\\n            INNER JOIN Categories\\\n            ON Products.CategoryID = Categories.CategoryID\\\n            WHERE Feature = 1';\n\n        RunQuery(sqlStr, function (products) {\n            var contextDict = {\n                currentUrl: '/',\n                title: 'Home',\n                categories: categories,\n                featProducts: products,\n                customer: req.user\n            };\n\n            //isLoggedIn(req, contextDict);\n            res.render('index', contextDict);\n        });\n    });\n});\n\n/* Route Category page. */\nrouter.route('/cat/')\n    .all(function (req, res, next) {\n        var sqlStr = '\\\n        SELECT *\\\n        FROM Categories';\n\n        RunQuery(sqlStr, function (categories) {\n            var contextDict = {\n                currentUrl: '/cat',\n                title: 'Categories',\n                categories: categories,\n                customer: req.user\n            };\n\n            res.render('categories', contextDict);\n        });\n    });\n\n    \nrouter.route('/orders/res/')\n.all(function (req, res, next) {\n\n        res.render('admin/base');\n});\n\n// router.get('/orders/res/kl',function(req,res){\n//         var datval = req.params.kl\n//         console.log(datval)\n//         // res.render('admin/base');\n\n// })\n\nrouter.post('/orders/res/kl', function(req,res){\n    console.log(req.body.dataone);\n    var klp = req.body.dataone\n    var lop = `'${klp}'`\n    var sqlStr = '\\\n    SELECT *\\\n    FROM orders WHERE OrderDate ='+lop ;\n    console.log(sqlStr)\n    RunQuery(sqlStr, function (emb) {\n    var contextDict = {\n        currentUrl: '/res/kl',\n        title: 'Search',\n        emb: emb,\n        customer: req.Status\n    };\n    console.log(\"CUSTOMER-----------------------------\")\n    console.log(contextDict.emb)\n    res.render('admin/result', contextDict);\n    });    \n    // res.render('admin/base');\n  });\n\n\n\n\n\n// .all(function (req, res) {\n//         var datval = req.params\n//         console.log(datval)\n//         res.render('admin/base');\n// });\n\n\n\nrouter.route('/orders/mm/')\n    .all(function (req, res, next) {\n        // var datval = req.params.datevalue\n        // console.log(datval)\n        var sqlStr = '\\\n              SELECT *\\\n              FROM orders WHERE OrderDate = \"2022-11-09\" ';\n\n        RunQuery(sqlStr, function (emb) {\n            var contextDict = {\n                currentUrl: '/mm',\n                title: 'Search',\n                emb: emb,\n                customer: req.Status\n            };\n            console.log(\"CUSTOMER-----------------------------\")\n            console.log(contextDict.emb)\n            res.render('admin/result', contextDict);\n        });\n    });\n\n\n// router.get('/orders/pp',function (req, res) {\n\n//     var selectQuery = '\\\n//               SELECT *\\\n//               FROM orders WHERE OrderDate = \"2022-04-06 16:51:10\" ';\n    \n//     RunQuery(selectQuery, function (customers) {\n//       var contextDict = {\n//         title: 'Admin - Customers',\n//         customer: req.Status,\n//         customers: customers,\n//       };\n      \n//         console.log(\"customers-------------------------\")\n//         res.render('admin/result');\n//     });\n\n\n\n\n\n/* Route Category Products page. */\nrouter.route('/cat/:catSlug')\n    .all(function (req, res, next) {\n        if (req.params.catSlug == \"all\") {\n            var selectQuery = '\\\n                SELECT Products.*, Categories.CategoryName, Categories.CategorySlug\\\n                FROM Products\\\n                INNER JOIN Categories\\\n                ON Products.CategoryID = Categories.CategoryID';\n\n            RunQuery(selectQuery, function (products) {\n\n                selectQuery = '\\\n                SELECT *\\\n                FROM Categories';\n\n                RunQuery(selectQuery, function (categories) {\n\n                    var contextDict = {\n                        title: 'All products',\n                        products: products,\n                        categories: categories,\n                        customer: req.user\n                    };\n\n                    res.render('categoryProducts', contextDict);\n                });\n            });\n        }\n        else {\n            var sqlStr = '\\\n                SELECT Products.*, Categories.CategoryName, Categories.CategorySlug\\\n                FROM Products\\\n                INNER JOIN Categories\\\n                ON Products.CategoryID = Categories.CategoryID\\\n                WHERE Categories.CategorySlug = \\'' + req.params.catSlug + '\\'';\n\n            RunQuery(sqlStr, function (products) {\n\n                sqlStr = '\\\n                SELECT *\\\n                FROM Categories';\n\n                RunQuery(sqlStr, function (categories) {\n\n                    var contextDict = {\n                        title: products[0].CategoryName,\n                        products: products,\n                        categories: categories,\n                        customer: req.user\n                    };\n\n                    res.render('categoryProducts', contextDict);\n                });\n            });\n        }\n    });\n\n/* Route Product page. */\nrouter.route('/cat/:catSlug/:prodSlug')\n    .all(function (req, res, next) {\n        var sqlStr = '\\\n        SELECT *\\\n        FROM Products\\\n        WHERE ProductSlug = \\'' + req.params.prodSlug + '\\'';\n\n        RunQuery(sqlStr, function (product) {\n\n            var contextDict = {\n                title: product[0].ProductName,\n                product: product[0],\n                customer: req.user\n            };\n\n            res.render('productDetail', contextDict);\n        });\n    });\n\nrouter.route('/subscribe')\n    .post(function (req, res, next) {\n        var sqlStr = '\\\n        INSERT INTO Subscribers\\\n        VALUES (\\'' + req.body.email + '\\')';\n\n        RunQuery(sqlStr, function (result) {\n            res.redirect('/');\n        });\n    });\n\n\nrouter.route('/eye')\n.get(function (req, res) {\n\n    res.render('eye');\n});\n\n\n\n// router.route('/eye-test')\n// .get(function (req, res) {\n//     res.render('eye');\n// });\n\n\n/* Route Login page.\n router.route('/login/')\n .get (function (req, res, next) {\n var contextDict = {\n title: 'Login'\n };\n res.render('login', contextDict);\n });\n\n .post(function (req, res, next) {\n //read inputs\n //validate inputs\n //redirect to account info page\n var contextDict = {\n title: '',\n signInError: req.flash('loginError')\n };\n res.render('template', contextDict);\n });\n */\n\nmodule.exports = router;\n"]}